<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Панель администратора - Пользователи</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='table.css') }}">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <img src="{{ url_for('static', filename='materials/Vector.png') }}" alt="Логотип">
            </div>
            <ul class="nav-links">
                <li><a href="{{ url_for('index') }}">Главная</a></li>
                <li><a href="#">Почему мы?</a></li>
                <li><a href="#">Как мы работаем?</a></li>
                <li><a href="#">Наша команда</a></li>
            </ul>
        </nav>
    </header>
    <div class="table-with-button">
        <!-- Кнопка для добавления нового пользователя -->
        <button class="icon-button" onclick="add_user()">
            <img src="{{ url_for('static', filename='materials/add_person.svg') }}" alt="Добавить">
        </button>
        <!-- Таблица пользователей -->
        <table>
            <thead>
                <tr>
                    <th>Имя пользователя</th>
                    <th>Кол-во проектов (выполненных)</th>
                    <th>Кол-во проектов (действующих)</th>
                    <th>Подробнее</th>
                </tr>
            </thead>
            <tbody>
                {% for item in data %}
                <tr>
                    <td>{{ item.user.full_name }}</td>
                    <td>{{ item.completed }}</td>
                    <td>{{ item.active }}</td>
                    <td>
                        <button class="details-button"
                        data-user='{"first_name": "{{ item.user.full_name.split()[1] }}",
                                    "last_name": "{{ item.user.full_name.split()[0] }}",
                                    "middle_name": "{{ item.user.full_name.split()[2] }}",
                                    "profile_picture": "{{ item.user.profile_picture }}",
                                    "projects": {{ item.projects | default([], true) | tojson }}
                                }'>
                            &rarr;
                        </button>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4">Нет зарегистрированных пользователей.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="overlay_" id="modalOverlay_" style="display: none;">
        <div class="modal_">
          <button class="close-btn_" id="closeModal_">&times;</button>
          <div class="modal-header_">
            <img src="" alt="Фото профиля" class="profile-pic_" id="profilePic_">
            <div class="user-info_">
              <div class="key">
                <h2>Имя</h2>
                <h2>Фамилия</h2>
                <h2>Отчество</h2>
              </div>
              <div class="value">
                <h2 id="firstName_"></h2>
                <h2 id="lastName_"></h2>
                <h2 id="middleName_"></h2>
              </div>
            </div>
          </div>
          <table class="projects-table_">
            <thead>
                <tr>
                <th>Проект</th>
                <th>Статус</th>
                <th>Дата</th>
                </tr>
            </thead>
            <tbody id="projectsTableBody_">
              <!-- Данные будут загружаться динамически -->
            </tbody>
          </table>
          <div class="table-navigation_">
            <button>&larr;</button>
            <button>&rarr;</button>
          </div>
        </div>
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <p>© 2025 PyroShield | Все права защищены</p>
            <p class="made-by">Сделано командой <span>ITshechka</span></p>
        </div>
    </footer>
    <script src="{{ url_for('static', filename='table.js') }}"></script>
</body>
</html>
